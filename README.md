# README #

### What is this repository for? ###

These scripts allow for automatic add and remove of new hosts to the shibboleth2.xml config file for a standard Shibboleth 2 instance.  There is a Perl script for Linux/Apache servers and Powershell for Windows/IIS servers.  Their functionality is very similar, though there are necessary differences due to contrasting shibboleth2.xml config on Apache vs. IIS.

## Linux/Apache (Perl) ##

### How do I get set up? ###

Script was developed for a shared hosting environment at University of Wisconsin - Madison and is tailored to the specifics of that configuration but with a few modifications could apply to most standard Shibboleth 2 instances.

The script can be run from command line with arguments passed to it.  In UW-Madison's web hosting setup, the script is fed the necessary arguments by an event handler whenever a site is created or removed, making the process fully automated.

The "preview" option is tailored specifically to the web hosting model at UW-Madison.  If you have no need to generate "preview" versions of your Host elements, just run the script without setting the "preview" option. It is off by default.

This script assumes the following:

1. You have installed Shibboleth 2 in the default file system location on a Linux/Apache web server

2. You have the following Perl modules installed on the web server:
XML::Writer; 
XML::LibXML; 
XML::LibXML::XPathContext; 
Getopt::Long; 
File::Copy; 

3. xmllint is available on your web server. See: http://xmlsoft.org/xmllint.html. If it is not, the recommended adjustment would be to add Perl's XML::LibXML::PrettyPrint module and alter the publish section of the script accordingly.

4. You have a standard naming convention for Shibboleth applicationIds that is based on the site's domain name (the script uses "https://<domain name>/shibboleth"). The convention used can be easily altered in the script, but it's important that you have a naming convention since the applicationId is generated by the script

5. You have created an /archive directory in the same directory that holds the main shibboleth2.xml.  

6. The Linux mail command is available -- only necessary if you choose to receive success or failure emails.  You can toggle the success or failure email settings in the CONFIGURABLE ELEMENTS section of the Perl script (line 75).

## Windows/IIS (Powershell) ##

### How do I get set up? ###

Script was developed for a shared hosting environment at University of Wisconsin - Madison and is tailored to the specifics of that configuration but with a few modifications could apply to most standard Shibboleth 2 instances.

The script can be run from command line with arguments passed to it.  In UW-Madison's web hosting setup, the script is fed the necessary arguments by an event handler whenever a site is created or removed, making the process fully automated.

The "preview" option is tailored specifically to the web hosting model at UW-Madison.  If you have no need to generate "preview" versions of your Site and Host elements, just run the script without setting the "preview" option. It is off by default.

This script assumes the following:

1. You have installed Shibboleth 2 in the default file system location on a Windows IIS web server

2. You have a standard naming convention for Shibboleth applicationIds that is based on the site's domain name (the script uses "https://<domain name>/shibboleth"). The convention used can be easily altered in the script, but it's important that you have a naming convention since the applicationId is generated by the script

3. You have created an \archive directory in the same directory that holds the main shibboleth2.xml.  

## License ##
Apache 2 (http://www.apache.org/licenses/LICENSE-2.0)

## Who do I talk to? ##

Benjamin Sousa, Division of Information Technology, University of Wisconsin-Madison ([benjamin.sousa@wisc.edu](mailto:benjamin.sousa@wisc.edu))